textLayer = require('TextLayer')
markerModule = require('MarkerModule')
{EventEmitter} = require 'events'

exports.Radar = class Radar extends Layer
  constructor: (@mainContext, options = {}) ->
    @pageComponent =  @mainContext.pageComponent
    @ListView =  @mainContext.ListView
    @backIcon = @mainContext.backIcon

    options.width= options.width ? Screen.width
    options.height= options.height ? Screen.height - 220
    options.opacity = options.opacity ? 1
    @myBackgroundColor = options.backgroundColor ? 'transparent'

    options.backgroundColor= @myBackgroundColor
    @title = "Radar"
    @currentSelection = null
    @markers = []
    @sliderValue = 1
    @currentRemainingValue = 500
    @marker_1_animated = false
    @marker_3_animated = false


    super options

    this.initControls()
    this.bindEvents()


  initControls: () ->

    @radarLayer = new Layer
      x:25
      y:Screen.height - 1070
      height: 700
      width: 700
      superLayer : this
      image:"./images/radar.png"


    @swing = new Layer
      x:@radarLayer.width - 350
      y:0
      width:354
      height:349
      originX:0
      originY:1
      image: "./images/swing_radar.png"
      opacity:1
      superLayer:@radarLayer

    @swingAnimation = new Animation
      layer: @swing
      properties:
        rotation: -360
        originX:0
        originY:1
      time: 3.5
      curve: "linear"

    # Start animation
    @swingAnimation.start()
    # Loop animation
    @swingAnimation.on Events.AnimationEnd, =>
    # Reset rotation before looping
      @swing.rotation = 0
      @swingAnimation.start()

    @zoomOut = null
    @zoomIn = null

#    #marker
    @marker_1 = new markerModule.Marker("Uebersee-Museum", "./images/uebersee-museum.png", x:550, y:250)


    @marker_1Animation_Turn = new Animation
      layer: @marker_1
      path: Path.fromString( "M572,300.5c0,-1 0,-2 0,-3c0,-1 -0.292908,-1.292908 -1,-2c-0.707092,-0.707092 -2.173096,-1.852722 -3,-3c-1.307434,-1.813995 -0.61731,-3.076111 -1,-4c-0.541199,-1.306549 -0.770264,-2.026764 -1,-3c-0.513733,-2.176239 -0.69342,-3.458801 -2,-4c-0.923889,-0.38269 -1,-1 -1,-2c0,-1 -1,-1 -1,-2c0,-1 0.38269,-2.076111 0,-3c-0.541199,-1.306549 -1.292908,-1.292908 -2,-2c-0.707092,-0.707092 0.707092,-2.292908 0,-3c-0.707092,-0.707092 -1,-1 -1,-2c0,-1 -0.292908,-1.292908 -1,-2c-0.707092,-0.707092 -1.292908,-0.292908 -2,-1c-0.707092,-0.707092 0.707092,-2.292908 0,-3c-0.707092,-0.707092 -1.292908,-0.292908 -2,-1c-0.707092,-0.707092 -1,-2 -1,-3c0,-1 -0.292908,-1.292908 -1,-2c-0.707092,-0.707108 0,-2 0,-3c0,-1 -1,-1 -1,-2c0,-1 0.30658,-2.458801 -1,-3c-0.923889,-0.38269 -1,-1 -1,-2c0,-1 -1,-1 -1,-2c0,-1 -0.292908,-1.292892 -1,-2c-0.707092,-0.707108 -1,-1 -1,-2c0,-1 -0.292908,-1.292892 -1,-2c-0.707092,-0.707108 -1,-2 -1,-3c0,-1 -1.458801,-0.693436 -2,-2c-0.38269,-0.923874 0.707092,-2.292892 0,-3c-0.707092,-0.707108 -1.292908,-0.292892 -2,-1c-0.707092,-0.707108 -0.292908,-1.292892 -1,-2c-0.707092,-0.707108 -1,-1 -1,-2c0,-1 -1,-1 -1,-2c0,-1 0.707092,-2.292892 0,-3c-0.707092,-0.707108 -1.61731,-0.076126 -2,-1c-0.541199,-1.306564 -1.292908,-1.292892 -2,-2c-0.707092,-0.707108 -0.292908,-1.292892 -1,-2c-0.707092,-0.707108 -1,-1 -1,-2c0,-1 -0.292908,-1.292892 -1,-2c-0.707092,-0.707108 -1.292908,-0.292892 -2,-1c-0.707092,-0.707108 -0.61731,-1.076126 -1,-2c-0.541199,-1.306564 -0.292908,-2.292892 -1,-3c-0.707092,-0.707108 -1.292908,-0.292892 -2,-1c-0.707092,-0.707108 -1,-1 -1,-2c0,-1 -1.292908,-0.292892 -2,-1c-0.707092,-0.707108 0,-2 -1,-2c-1,0 -1.292908,-0.292892 -2,-1c-0.707092,-0.707108 -0.292908,-1.292892 -1,-2c-0.707092,-0.707108 -1,-1 -2,-1c-1,0 -1.292908,-0.292892 -2,-1c-0.707092,-0.707108 -0.292908,-1.292892 -1,-2c-0.707092,-0.707108 -1.458801,-0.693436 -2,-2c-0.38269,-0.923874 -0.292908,-2.292892 -1,-3c-0.707092,-0.707108 -1.292908,-0.292892 -2,-1c-0.707092,-0.707108 0,-2 -1,-2c-1,0 -0.292908,-1.292892 -1,-2c-0.707092,-0.707108 -1.292908,-0.292892 -2,-1c-0.707092,-0.707108 -1,-1 -1,-2c0,-1 -1.292908,-0.292892 -2,-1c-0.707092,-0.707108 -0.292908,-1.292892 -1,-2c-0.707092,-0.707108 -1.292908,-0.292892 -2,-1c-0.707092,-0.707108 -0.292908,-1.292892 -1,-2c-0.707092,-0.707108 -2,0 -2,-1c0,-1 -1.292908,-0.292892 -2,-1c-0.707092,-0.707108 -0.292908,-1.292892 -1,-2c-0.707092,-0.707108 -2,0 -2,-1c0,-1 -1.292908,-0.292892 -2,-1c-0.707092,-0.707108 -0.292908,-1.292892 -1,-2c-0.707092,-0.707108 -1.292908,-0.292892 -2,-1c-0.707092,-0.707108 -1.292908,-0.292892 -2,-1c-0.707092,-0.707108 -1.292908,-0.292892 -2,-1c-0.707092,-0.707108 -0.292908,-1.292892 -1,-2c-0.707092,-0.707108 -2.292908,-0.292892 -3,-1c-0.707092,-0.707108 -1.292908,-0.292892 -2,-1c-0.707092,-0.707108 -0.292908,-1.292892 -1,-2c-0.707092,-0.707108 -1.292908,-0.292892 -2,-1c-0.707092,-0.707108 -2.292908,0.707108 -3,0c-0.707092,-0.707108 -0.292908,-1.292892 -1,-2c-0.707092,-0.707108 -1.292908,-0.292892 -2,-1c-0.707092,-0.707108 -1.292908,-0.292892 -2,-1c-0.707092,-0.707108 -1.292908,-0.292892 -2,-1c-0.707092,-0.707108 -2.076111,-0.61731 -3,-1c-1.306549,-0.541199 -2.585785,-0.585785 -4,-2c-0.707092,-0.707108 -1.292908,-0.292892 -2,-1c-0.707092,-0.707108 -1.076111,-0.61731 -2,-1c-1.306549,-0.541199 -1.292908,-1.292892 -2,-2c-0.707092,-0.707108 -2.292908,0.707108 -3,0c-0.707092,-0.707108 -1,-1 -2,-1c-1,0 -1,-1 -2,-1c-1,0 -1.292908,-0.292892 -2,-1c-0.707092,-0.707108 -1,-1 -2,-1c-1,0 -1.292908,-0.292892 -2,-1c-0.707092,-0.707108 -2.292908,0.707108 -3,0c-0.707092,-0.707108 -1,-2 -2,-2c-1,0 -1.292908,-0.292892 -2,-1c-0.707092,-0.707108 -2.292908,0.707108 -3,0c-0.707092,-0.707108 -1,-1 -2,-1c-1,0 -1.292908,-0.292892 -2,-1c-0.707092,-0.707108 -2,-1 -3,-1c-1,0 -2.292908,0.707108 -3,0c-0.707092,-0.707108 -1.012909,-0.839813 -2,-1c-3.121429,-0.506546 -3.693451,-1.458801 -5,-2c-0.923889,-0.38269 -2.292908,0.707108 -3,0c-0.707092,-0.707108 -1,-1 -2,-1c-1,0 -2,0 -3,0c-1,0 -2.292908,0.707108 -3,0c-0.707092,-0.707108 -1,-1 -2,-1c-1,0 -2,0 -3,0c-1,0 -1.292908,-0.292892 -2,-1c-0.707092,-0.707108 -2.076111,0.382683 -3,0c-1.306549,-0.541199 -2,-1 -3,-1c-1,0 -2,0 -3,0c-1,0 -1,-1 -2,-1c-1,0 -2,0 -3,0c-1,0 -0.823761,-1.486259 -3,-2c-1.946503,-0.459503 -3,0 -4,0c-1,0 -1,-1 -2,-1c-1,0 -2.292908,0.707108 -3,0c-0.707092,-0.707108 -1,-1 -2,-1c-1,0 -2,0 -3,0c-1,0 -2,0 -3,0c-1,0 -1,-1 -2,-1c-1,0 -2.292908,0.707108 -3,0c-0.707092,-0.707108 -1,-1 -2,-1c-1,0 -2,0 -3,0l0,-1")
      curve: 'linear'
      time: 2
      pathOptions:
        autoRotate: false


    @marker_1Animation_slowWalk= new Animation
      layer: @marker_1
      path: Path.fromString( "M349,119.5c0,0 0,1 0,2c0,1 1,1 1,2c0,1 0,2 0,3c0,0 0,1 0,2c0,1 0,2 0,3c0,1 -0.707092,2.292892 0,3c0.707092,0.707108 1,1 1,2c0,1 0,2 0,3c0,1 -0.707092,2.292892 0,3c0.707092,0.707108 1,1 1,2c0,1 0,2 0,3c0,1 0.707092,2.292892 0,3c-0.707092,0.707108 -1,1 -1,2c0,1 0,2 0,3c0,1 0,2 0,3c0,1 0,2 0,3c0,1 0,2 0,3c0,1 0,2 0,3c0,1 -0.707092,2.292892 0,3c0.707092,0.707108 1,1 1,2c0,1 0,2 0,3l0,1l0,1l0,1")
      curve: 'linear'
      time: 1
      pathOptions:
        autoRotate: false

    @marker_1Animation_slowWalk.on Events.AnimationStart, =>
      @startTime = new Date
      @lastTime = @startTime
      @lastAnimationTime = 14
      @lastMaxDistance = 500

    @marker_1Animation_slowWalk.on Events.AnimationEnd, =>
      @marker_1.isMoveToMeSlow = false
      @marker_1Animation_quickWalk.start()
      @marker_1.isMoveToMeFast = true

    @marker_1Animation_quickWalk = new Animation
      layer: @marker_1
      path: Path.fromString( "M350,175.5c0,0 0.292908,0.292892 1,1c0.707092,0.707108 1,0 1,1c0,1 0,2 0,3c0,1 0,2 0,3c0,1 0,2 0,3c0,1 0,2 0,3c0,1 0,2 0,3c0,1 0,2 0,3c0,1 0,2 0,3c0,1 0,2 0,3c0,1 0,2 0,3c0,1 0,2 0,3c0,1 0,2 0,3c0,1 0,2 0,3c0,1 0.292908,1.292892 1,2c0.707092,0.707108 0,2 0,3c0,1 0,2 0,3c0,1 0,2 0,3c0,1 0,2 0,3c0,1 0,2 0,3c0,1 0,2 0,3c0,1 0,2 0,3c0,1 -0.458801,1.693436 -1,3c-0.38269,0.923874 0,2 0,3c0,1 -1,1 -1,2c0,1 0,2 0,3c0,1 0,2 0,3c0,1 0,2 0,3c0,1 0,2 0,3c0,1 0,2 0,3c0,1 0,2 0,3c0,1 0,2 0,3c0,1 0,2 0,3c0,1 0,2 0,3c0,1 0,2 0,3c0,1 0,2 0,3c0,1 0,2 0,3c0,1 0,2 0,3c0,1 0,2 0,3c0,1 0,2 0,3c0,1 1,1 1,2c0,1 0,2 0,3c0,1 0,2 0,3c0,1 0,2 0,3c0,1 -0.707092,2.292908 0,3c0.707092,0.707092 1,1 1,2c0,1 0,2 0,3c0,1 0,2 0,3c0,1 0,2 0,4c0,1 0,2 0,3c0,1 0,2 0,3c0,1 -1,1 -1,2c0,1 0,2 0,3c0,1 0.707092,2.292908 0,3c-0.707092,0.707092 -1,1 -1,2c0,1 0,2 0,3c0,1 0,2 0,3c0,1 -0.292908,1.292908 -1,2c-0.707092,0.707092 0,2 0,3c0,1 -0.707092,2.292908 0,3c0.707092,0.707092 1,1 1,2l1,0")
      curve: 'linear'
      time: 1
      pathOptions:
        autoRotate: false

    @marker_1Animation_moveAwaySlow = new Animation
      layer: @marker_1
      path: Path.fromString( "M350,344.5c0,1 0,2 0,3c0,1 0,2 0,3c0,1 0,2 0,3c0,1 1,3 1,4c0,1 0.292908,2.292908 1,3c0.707092,0.707092 1,1 1,2c0,1 0.292908,1.292908 1,2c0.707092,0.707092 0.292908,1.292908 1,2c0.707092,0.707092 1,1 1,2c0,1 0.292908,1.292908 1,2c0.707092,0.707092 1,1 1,2c0,1 0.292908,2.292908 1,3c0.707092,0.707092 0.292908,1.292908 1,2c0.707092,0.707092 1.292908,0.292908 2,1c0.707092,0.707092 0,2 0,3c0,1 1.486267,0.823761 2,3c0.229767,0.973236 1,2 1,3c0,1 1.458801,0.693451 2,2c0.38269,0.923889 0.292908,2.292908 1,3c0.707092,0.707092 0.61731,1.076111 1,2c0.541199,1.306549 2,2 2,4c0,1 1,3 1,4c0,1 -0.414215,1.585785 1,3c0.707092,0.707092 1,1 1,2c0,1 0.458801,1.693451 1,3c0.765381,1.847748 0.292908,2.292908 1,3c0.707092,0.707092 -0.707092,2.292908 0,3c0.707092,0.707092 1.486267,0.823761 2,3c0.229767,0.973236 1,1 1,2c0,1 0,2 0,3c0,1 1,2 1,3c0,1 -0.707092,2.292908 0,3c0.707092,0.707092 1,1 1,2c0,1 -0.707092,2.292908 0,3c0.707092,0.707092 1,1 1,2c0,1 1,2 1,3c0,1 0.458801,1.693451 1,3c0.765381,1.847748 -0.765381,3.152252 0,5c0.541199,1.306549 1,3 1,4c0,1 -0.38269,2.076111 0,3c0.541199,1.306549 1,3 1,4c0,1 0.458801,1.693451 1,3c0.38269,0.923889 0.458801,1.693451 1,3c0.38269,0.923889 0.486267,1.823761 1,4c0.229767,0.973236 0,3 0,4c0,2 1,4 1,6c0,1 1.458801,1.693451 2,3c0.38269,0.923889 0.292908,1.292908 1,2c0.707092,0.707092 0,2 1,3c1,1 0.292908,2.292908 1,3c0.707092,0.707092 1,2 2,3c1,1 1.486267,1.823761 2,4c0.229767,0.973236 -0.414215,1.585785 1,3c0.707092,0.707092 0.292908,1.292908 1,2c0.707092,0.707092 1.292908,0.292908 2,1c0.707092,0.707092 0.292908,1.292908 1,2c0.707092,0.707092 0.292908,1.292908 1,2c0.707092,0.707092 1,1 2,4l0,1l1,1")
      curve: 'linear'
      time: 1
      pathOptions:
        autoRotate: false

    @marker_1Animation_moveAwaySlow.on Events.AnimationStart, =>
      @startTime = new Date
      @lastTime = @startTime
      @lastAnimationTime = 13
      @lastMaxDistance = 500
      @currentRemainingValue = 1500


    @marker_2 = new markerModule.Marker("Roland", "./images/roland.png", x:180, y:0)

    @marker_2Animation_Turn = new Animation
      layer: @marker_2
      path: Path.fromString("M206,47.5c-1,0 -2,0 -3,0c-1,0 -2.21167,0.714119 -5,3c-2.187347,1.79319 -3.881516,4.190277 -7,6c-1.93399,1.122341 -5.186005,2.692547 -7,4c-2.29454,1.653809 -4,3 -6,4c-2,1 -3.418854,1.418861 -5,3c-1.581146,1.581139 -3.186005,2.692551 -5,4c-2.29454,1.653809 -4,4 -5,5c-1,1 -2.418854,2.418861 -4,4c-1.581146,1.581139 -1.852737,3.173096 -3,4c-1.813995,1.307449 -2.852737,3.173096 -4,4c-1.813995,1.307449 -4.076126,2.617317 -5,3c-1.306564,0.541199 -2,2 -4,3c-2,1 -2.292892,1.292892 -3,2c-1.414215,1.414215 -2.852737,1.173096 -4,2c-1.813995,1.307449 -3.186005,1.692551 -5,3c-1.147263,0.826904 -2.186005,1.692551 -4,3c-1.14727,0.826904 -2.94854,2.298698 -4,4c-1.175568,1.902115 -3,1 -4,2c-1,1 -3.149345,2.474266 -4,3c-1.902115,1.175568 -1.292892,2.292892 -2,3c-0.707108,0.707108 -2.149345,0.474266 -3,1c-1.902115,1.175568 -1.386871,3.91761 -4,5c-0.923882,0.382683 -1.292892,0.292892 -2,1c-0.707108,0.707108 -1.458801,1.693436 -2,3c-0.382683,0.923882 -1.692551,2.186005 -3,4c-0.826904,1.147263 -3.458801,2.693436 -4,4c-0.382683,0.923874 -0.292892,2.292892 -1,3c-0.707108,0.707108 -2,0 -2,1c0,1 -0.076118,1.61731 -1,2c-1.306564,0.541199 -1,2 -2,2c-1,0 -1.292892,1.292892 -2,2c-0.707108,0.707108 -2,1 -2,2c0,1 -0.292892,2.292892 -1,3c-0.707108,0.707108 -2.292892,2.292892 -3,3c-0.707108,0.707108 -0.292892,1.292892 -1,2c-0.707108,0.707108 -2.458801,0.693436 -3,2c-0.382683,0.923874 -1,1 -1,2c0,1 -0.617317,1.076126 -1,2c-0.541199,1.306564 -1.292892,1.292892 -2,2c-0.707108,0.707108 -0.458801,1.693436 -1,3c-0.382683,0.923874 -1,1 -1,2c0,1 0.707108,2.292892 0,3c-0.707108,0.707108 -0.617317,2.076126 -1,3c-0.541199,1.306564 -1.91761,1.386871 -3,4c-0.765366,1.847763 -0.617317,3.076126 -1,4c-0.541199,1.306564 -1.617317,2.076126 -2,3c-0.541195,1.306564 -1.292892,2.292892 -2,3c-0.707108,0.707108 -0.458805,1.693436 -1,3c-0.382683,0.923874 -0.617317,2.076126 -1,3c-0.541195,1.306564 -1,3 -2,4c-1,1 -0.617317,2.076126 -1,3c-0.541195,1.306564 -1,2 -1,3c0,1 -0.292892,1.292892 -1,2c-0.707108,0.707108 -1.617317,2.076126 -2,3c-0.541195,1.306564 -0.693436,2.458801 -2,3c-0.923878,0.38269 -1.292892,0.292892 -2,1c-1.414215,1.414215 -0.292892,2.292892 -1,3c-0.707108,0.707108 -0.292892,1.292892 -1,2c-0.707108,0.707108 -0.292892,1.292892 -1,2c-0.707108,0.707108 -0.617317,1.076126 -1,2c-0.541195,1.306564 -1.617317,2.076126 -2,3c-0.541195,1.306564 -0.692547,2.186005 -2,4c-0.826904,1.147263 -1.234634,2.152237 -2,4c-0.541195,1.306564 -0.693436,2.458801 -2,3c-0.923878,0.38269 -1,1 -1,2c0,1 0.707108,2.292892 0,3c-0.707108,0.707108 -1,1 -1,2c0,1 -1,1 -1,2c0,2 -0.917606,3.386871 -2,6c-0.765368,1.847763 -0.458803,2.693436 -1,4c-0.765368,1.847748 -0.234632,4.152252 -1,6c-0.541197,1.306549 -2,3 -2,4c0,1 0.707108,2.292908 0,3c-0.707108,0.707092 -1,1 -1,2c0,1 -0.292892,1.292908 -1,2c-0.707108,0.707092 -0.458803,1.693451 -1,3c-0.382683,0.923889 -0.486258,1.823761 -1,4c-0.229753,0.973236 -1,3 -1,4c0,1 -0.617317,2.076111 -1,3c-0.541197,1.306549 -1,3 -1,4c0,1 -1,1 -1,2c0,1 0,2 0,3c0,1 -1.458803,1.693451 -2,3c-0.382683,0.923889 0,2 0,3c0,1 -1,2 -1,3c0,1 -0.458803,2.693451 -1,4c-0.382684,0.923889 0,2 0,3c0,1 0,2 0,3c0,1 0,2 0,3c0,1 0,2 0,3c0,1 0,2 0,3c0,1 -0.707107,2.292908 0,3c0.707108,0.707092 1,1 1,2c0,1 0,2 0,3c0,1 0.292892,1.292908 1,2c0.707108,0.707092 -0.707108,2.292908 0,3c0.707108,0.707092 1,1 1,2l0,1")
      curve: 'linear'
      time: 2
      pathOptions:
        autoRotate: false

    @marker_2Animation_Turn_2 = new Animation
      layer: @marker_2
      path: Path.fromString("M21,337.5c0,1 0,2 0,3c0,1 0,2 0,3c0,1 0,2 0,3c0,1 0,2 0,3c0,1 0,2 0,3c0,1 0,2 0,3c0,1 0,2 0,3c0,1 0,2 0,3c0,1 0,2 0,3c0,1 0,2 0,3c0,1 0,2 0,3c0,1 0,2 0,3c0,1 0,2 0,3c0,1 0,2 0,3c0,1 0,2 0,3c0,1 0,2 0,3c0,1 0,2 0,2c0,1 0,2 0,3c0,1 0,2 0,3c0,1 1,1 1,2c0,1 -0.707108,2.292908 0,3c0.707108,0.707092 1,1 1,2c0,1 0.458803,1.693451 1,3c0.382683,0.923889 0.458803,1.693451 1,3c0.382683,0.923889 0.292892,1.292908 1,2c0.707108,0.707092 0,2 0,3c0,1 -0.707108,2.292908 0,3c0.707108,0.707092 1,1 1,2c0,1 0,2 0,3c0,1 0.292892,1.292908 1,2c0.707108,0.707092 -0.707108,2.292908 0,3c0.707108,0.707092 1,1 1,2c0,1 0,2 0,3c0,1 -0.707108,2.292908 0,3c0.707108,0.707092 1,1 1,2c0,1 -0.707108,2.292908 0,3c0.707108,0.707092 0.617317,1.076111 1,2c0.541197,1.306549 1,2 1,3c0,1 0,2 0,3c0,1 1,1 1,2c0,1 -0.707108,2.292908 0,3c0.707108,0.707092 1,1 1,2c0,1 -0.707108,2.292908 0,3c0.707108,0.707092 0.292892,1.292908 1,2c0.707108,0.707092 1,1 1,2c0,1 1,1 1,2c0,1 1,1 1,2c0,1 1,1 1,2c0,1 1,2 1,3c0,1 1,1 1,2c0,1 0.292892,1.292908 1,2c0.707108,0.707092 0.292892,1.292908 1,2c0.707108,0.707092 0,2 0,3c0,1 1,1 1,2c0,1 0.292892,1.292908 1,2c0.707108,0.707092 1,1 1,2c0,1 0.292892,1.292908 1,2c0.707108,0.707092 1,2 1,3c0,1 1.292892,0.292908 2,1c0.707108,0.707092 -0.707108,2.292908 0,3c0.707108,0.707092 1.292892,0.292908 2,1c0.707108,0.707092 1,1 1,2c0,1 0.292892,1.292908 1,2c0.707108,0.707092 0.617317,1.076111 1,2c0.541195,1.306549 1.617317,2.076111 2,3c0.541195,1.306549 2,2 3,3c1,1 0.693436,2.458801 2,3c0.923878,0.38269 1.292892,0.292908 2,1c0.707108,0.707092 1,1 1,2c0,1 0.292892,1.292908 1,2c0.707108,0.707092 0.292892,1.292908 1,2c0.707108,0.707092 0.877655,1.065979 2,3c1.809723,3.118469 2.692551,4.186035 4,6c0.826904,1.147278 1.292892,2.292908 2,3c0.707108,0.707092 1.292892,1.292908 2,2c0.707108,0.707092 1,1 1,2c0,1 1,1 1,2c0,1 0,2 1,2c1,0 0.292892,1.292908 1,2c0.707108,0.707092 0.292892,1.292908 1,2c0.707108,0.707092 0.693436,1.458801 2,2c0.923882,0.38269 1.292892,0.292908 2,1c0.707108,0.707092 1,1 1,2c0,1 0.292892,1.292908 1,2c0.707108,0.707092 0.292892,1.292908 1,2c0.707108,0.707092 0.292892,1.292908 1,2c0.707108,0.707092 1.292892,0.292908 2,1c0.707108,0.707092 0.292892,1.292908 1,2c0.707108,0.707092 1,1 1,2c0,1 1.292892,0.292908 2,1c0.707108,0.707092 0,2 0,3c0,1 1,1 1,2c0,1 0.292892,1.292908 1,2c0.707108,0.707092 0.292892,1.292908 1,2c0.707108,0.707092 0.292892,1.292908 1,2c0.707108,0.707092 1,1 2,1l0,1l0,1l1,0")
      curve: 'linear'
      time: 1
      pathOptions:
        autoRotate: false

    @marker_2Animation_Turn_3 = new Animation
      layer: @marker_2
      path: Path.fromString("M98,570.5c0,-1 -0.292892,-1.292908 -1,-2c-0.707108,-0.707092 -0.292892,-1.292908 -1,-2c-0.707108,-0.707092 -0.292892,-1.292908 -1,-2c-0.707108,-0.707092 -0.292892,-1.292908 -1,-2c-0.707108,-0.707092 -2,0 -2,-1c0,-1 -0.292892,-1.292908 -1,-2c-0.707108,-0.707092 -0.292892,-1.292908 -1,-2c-0.707108,-0.707092 -2,0 -2,-1c0,-1 -0.292892,-1.292908 -1,-2c-0.707108,-0.707092 -0.292892,-1.292908 -1,-2c-0.707108,-0.707092 -1,-1 -1,-2c0,-1 -1,-1 -1,-2c0,-1 -1,-1 -1,-2c0,-1 -0.617317,-1.076111 -1,-2c-0.541199,-1.30658 -1.292892,-1.292908 -2,-2c-0.707108,-0.707092 -0.292892,-1.292908 -1,-2c-0.707108,-0.707092 -0.770248,-1.026733 -1,-2c-0.513741,-2.17627 -1.292892,-2.292908 -2,-3c-0.707108,-0.707092 -0.292892,-2.292908 -1,-3c-0.707108,-0.707092 -0.617317,-1.076111 -1,-2c-0.541199,-1.30658 -0.292892,-2.292908 -1,-3c-0.707108,-0.707092 -1.617317,-1.076111 -2,-2c-0.541199,-1.30658 -1.292892,-2.292908 -2,-3c-0.707108,-0.707092 -1.486259,-0.82373 -2,-3c-0.229752,-0.973267 -1,-1 -1,-2c0,-1 -0.292892,-1.292908 -1,-2c-0.707108,-0.707092 -0.292892,-1.292908 -1,-2c-0.707108,-0.707092 -0.292892,-1.292908 -1,-2c-0.707108,-0.707092 -0.486256,-1.823761 -1,-4c-0.229752,-0.973236 -0.617317,-2.076111 -1,-3c-0.541195,-1.306549 -0.292892,-2.292908 -1,-3c-0.707108,-0.707092 -1,-1 -1,-2c0,-1 -0.292892,-1.292908 -1,-2c-0.707108,-0.707092 0,-2 0,-3c0,-1 -0.617317,-1.076111 -1,-2c-0.541195,-1.306549 -0.770248,-2.026764 -1,-3c-0.513744,-2.176239 -0.770248,-3.026764 -1,-4c-0.513744,-2.176239 -2,-2 -2,-3c0,-1 0.707108,-2.292908 0,-3c-0.707108,-0.707092 -1,-1 -1,-2c0,-1 0.707108,-2.292908 0,-3c-0.707108,-0.707092 -1,-1 -1,-2c0,-1 -1.458805,-2.693451 -2,-4c-0.382683,-0.923889 0,-2 0,-3c0,-1 -1,-1 -1,-3c0,-1 -1.486256,-0.823761 -2,-3c-0.229752,-0.973236 -1,-2 -1,-3c0,-1 -1,-1 -1,-2c0,-1 0.707108,-2.292908 0,-3c-0.707108,-0.707092 -1.292892,-0.292908 -2,-1c-1.414215,-1.414215 -0.458805,-2.693451 -1,-4c-0.382683,-0.923889 0.707108,-2.292908 0,-3c-0.707108,-0.707092 -0.292892,-1.292908 -1,-2c-0.707108,-0.707092 -1,-1 -1,-2c0,-2 -0.458805,-2.693451 -1,-4c-0.382683,-0.923889 0,-2 0,-3c0,-2 -1,-3 -1,-5c0,-1 -0.458805,-1.693451 -1,-3c-0.765366,-1.847748 -1,-3 -1,-4c0,-1 -0.486256,-1.823761 -1,-4c-0.229752,-0.973236 -0.173096,-3.852722 -1,-5c-1.307451,-1.813995 -1,-3 -1,-5c0,-1 -0.486258,-1.823761 -1,-4c-0.229753,-0.973236 0,-3 0,-4c0,-1 -0.49346,-2.878571 -1,-6c-0.320364,-1.974182 0,-4 0,-5c0,-2 -0.458803,-2.693451 -1,-4c-0.765368,-1.847748 0,-3 0,-4c0,-2 0,-3 0,-5c0,-1 -1,-2 -1,-4c0,-1 0,-2 0,-4c0,-1 0,-2 0,-3c0,-1 0,-3 0,-4c0,-2 0,-5 0,-7c0,-1 -0.765368,-4.152252 0,-6c0.541197,-1.306549 1,-2 1,-4c0,-1 0,-3 0,-4c0,-1 0,-3 0,-4c0,-2 0,-3 0,-5c0,-2 0,-4 0,-5c0,-1 1,-3 1,-4c0,-2 0,-4 0,-6c0,-1 0,-3 0,-5c0,-2 1,-4 1,-6c0,-2 1.486256,-3.823761 2,-6c0.229752,-0.973236 0,-2 0,-3c0,-1 1,-1 1,-2c0,-1 0.458805,-2.693451 1,-4c0.765366,-1.847748 1,-3 1,-4c0,-2 0,-3 0,-5c0,-2 1,-2 1,-4c0,-1 0,-2 0,-3c0,-1 0.292892,-1.292908 1,-2c0.707108,-0.707092 0,-2 0,-3c0,-1 1,-1 1,-2c0,-1 -0.382683,-2.076111 0,-3c0.541195,-1.306549 1,-3 1,-4c0,-2 1,-2 1,-4c0,-1 -0.382683,-2.076126 0,-3c0.541195,-1.306564 0.234634,-2.152237 1,-4c0.541195,-1.306564 0.292892,-2.292892 1,-3c0.707108,-0.707108 1,-1 1,-2c0,-1 0.458805,-1.693436 1,-3c0.382683,-0.923874 -1.051464,-2.298691 0,-4c1.175571,-1.902115 2.486256,-2.823746 3,-5c0.459507,-1.946503 1.486256,-3.823746 2,-6c0.459507,-1.946503 1,-3 1,-4c0,-1 0.310741,-2.080246 1,-5c0.513744,-2.176254 1.770248,-4.026749 2,-5c0.513744,-2.176254 0.770248,-3.026749 1,-4c0.513744,-2.176254 1.540493,-3.053497 2,-5c0.513744,-2.176254 1.234634,-4.152237 2,-6c1.082394,-2.613129 1.789848,-4.07843 3,-7c0.855705,-2.065857 2,-4 2,-5c0,-1 0.292892,-3.292892 1,-4c0.707108,-0.707108 0.617317,-1.076126 1,-2c0.541199,-1.306564 2.458801,-1.693436 3,-3c0.382683,-0.923874 0.292892,-1.292892 1,-2c0.707108,-0.707108 1.458801,-1.693436 2,-3c0.382683,-0.923874 0.770248,-1.026749 1,-2c0.513741,-2.176254 2.486259,-2.823746 3,-5c0.229752,-0.973251 1.186005,-2.692551 3,-4c1.14727,-0.826904 2.173096,-2.852737 3,-4c1.307449,-1.813995 2.173096,-2.852737 3,-4c1.307449,-1.813995 2,-3 4,-5c1,-1 2,-3 4,-5c2,-2 3,-3 4,-4c1,-1 2.076118,-1.61731 3,-2c1.306564,-0.541199 2.617317,-3.076126 3,-4c0.541199,-1.306564 2,-1 4,-3c1,-1 2,-2 3,-3c1,-1 2,-2 3,-3c1,-1 2.186005,-1.692551 4,-3c1.14727,-0.826904 1.292892,-2.292892 2,-3c1.414215,-1.414215 2.292892,-2.292892 3,-3c0.707108,-0.707108 1.292892,-0.292892 2,-1c0.707108,-0.707108 1.076118,-0.617317 2,-1c1.306564,-0.541199 1.85273,-2.173096 3,-3c1.813995,-1.307449 2.693436,-2.458801 4,-3c0.923874,-0.382683 1.292892,-1.292892 2,-2c1.414215,-1.414215 3,-1 4,-2c1,-1 2,-1 3,-2c1,-1 2,-1 4,-3c1,-1 2.418854,-2.418861 4,-4c1.581146,-1.581139 3,-2 4,-3c1,-1 1.693436,-2.458801 3,-3c0.923874,-0.382683 1.149353,-0.474266 2,-1c1.902115,-1.175568 3.418854,-3.418861 5,-5c1.581146,-1.581139 2.852737,-2.173096 4,-3c1.813995,-1.307449 2.076126,-1.617317 3,-2c1.306564,-0.541199 2.292892,-0.292892 3,-1c0.707108,-0.707108 0.292892,-1.292892 1,-2c0.707108,-0.707108 2.823746,-1.486259 5,-2c1.946503,-0.459503 3.152237,-1.234634 5,-2c1.306564,-0.541199 2.097885,-2.824432 4,-4c1.701309,-1.051464 2.852737,-1.173096 4,-2c1.813995,-1.307453 3.076126,-1.617317 4,-2c1.306564,-0.541195 2,-2 4,-3c2,-1 3,-1 4,-2c1,-1 1.693436,-1.458805 3,-2c0.923874,-0.382683 2.026749,-0.770248 3,-1c2.176254,-0.513744 4,-2 6,-3c2,-1 3.823746,-2.486256 6,-3c0.973251,-0.229752 1,-1 2,-1c1,0 1.693436,-0.458805 3,-1c1.847763,-0.765366 3,-1 4,-1c1,0 1.693436,-0.458805 3,-1c0.923874,-0.382683 1.292892,-0.292892 2,-1c0.707108,-0.707108 1.292892,-0.292892 2,-1c1.414215,-1.414215 4,-1 6,-1c1,0 3,-1 4,-1c2,0 2.693436,-1.458805 4,-2c2.771637,-1.148048 5.053497,0.459507 7,0c2.176239,-0.513744 4,-1 7,-1c3,0 6.080261,-0.310741 9,-1c2.176239,-0.513744 4,-1 5,-1c2,0 4.025818,0.320366 6,0c3.121429,-0.50654 5,-1 7,-1c2,0 4,0 5,0c1,0 2,0 3,0c2,0 5,-1 8,-1c3,0 5,0 6,0c2,0 3.026764,0.229753 4,0c2.176239,-0.513742 4,-1 6,-1c2,0 3,0 4,0c2,0 3.053497,0.459505 5,0c2.176239,-0.513742 4,-1 6,-1c1,0 2,0 3,0c1,0 3,0 6,0c1,0 6,0 8,0c2,0 4,0 6,0c1,0 2,0 3,0c1,0 1.292908,0.292892 2,1c0.707092,0.707108 2,0 3,0c2,0 4,1 6,1c2,0 3,0 5,0c1,0 2,1 4,1c2,0 4.025818,-0.320364 6,0c3.121429,0.506542 4.823761,1.486256 7,2c0.973236,0.229752 2,0 3,0c1,0 2.076111,-0.382683 3,0c1.306549,0.541195 2,1 3,1c1,0 2.026764,-0.229752 3,0c2.176239,0.513744 2.693451,1.458805 4,2c1.847748,0.765366 3,0 4,0c2,0 3,1 4,1c1,0 2,0 3,0c1,0 2,0 3,0c1,0 2,1 3,1c1,0 2,0 3,0c1,0 2.292908,-0.707108 3,0c0.707092,0.707108 1,1 2,1c1,0 1.292908,0.292892 2,1c0.707092,0.707108 2,0 3,0c1,0 2.076111,-0.382683 3,0c1.306549,0.541195 2,1 3,1c1,0 1.415283,0.188759 2,1c1.84903,2.565372 4,1 5,1l1,0l1,0")
      curve: 'linear'
      time: 2
      pathOptions:
        autoRotate: false

    @marker_3 = new markerModule.Marker("Bremer-Stadtmusikanten", "./images/stadtmusikanten.png", x:50, y:100)

    @marker_3Animation_Turn = new Animation
      layer: @marker_3
      path: Path.fromString( "M76,146.5c0,1 -1,1 -1,2c0,1 -1,1 -1,2c0,1 0.707108,2.292892 0,3c-0.707108,0.707108 -1,1 -1,2c0,1 -0.292892,1.292892 -1,2c-0.707108,0.707108 -0.292892,1.292892 -1,2c-0.707108,0.707108 -0.292892,1.292892 -1,2c-0.707108,0.707108 -0.292892,1.292892 -1,2c-0.707108,0.707108 -1.292892,0.292892 -2,1c-0.707108,0.707108 -0.292892,1.292892 -1,2c-0.707108,0.707108 -0.292892,1.292892 -1,2c-0.707108,0.707108 -0.292892,1.292892 -1,2c-0.707108,0.707108 -0.292892,1.292892 -1,2c-0.707108,0.707108 -1.292892,0.292892 -2,1c-0.707108,0.707108 -1,1 -1,2c0,1 -1,1 -1,2c0,1 -1.292892,0.292892 -2,1c-0.707108,0.707108 -0.292892,1.292892 -1,2c-0.707108,0.707108 -0.292892,1.292892 -1,2c-0.707108,0.707108 -0.292892,1.292892 -1,2c-0.707108,0.707108 -1,1 -1,2c0,1 -0.292892,1.292892 -1,2c-0.707108,0.707108 -0.292892,1.292892 -1,2c-0.707108,0.707108 -1,1 -1,2c0,1 -1,1 -1,2c0,1 -1,1 -1,2c0,1 -0.292892,1.292892 -1,2c-0.707108,0.707108 -1.292892,0.292892 -2,1c-0.707108,0.707108 -0.292892,1.292892 -1,2c-0.707108,0.707108 -1,1 -1,2c0,1 -0.292892,1.292892 -1,2c-0.707108,0.707108 0.707108,2.292892 0,3c-0.707108,0.707108 -0.292892,1.292892 -1,2c-0.707108,0.707108 -0.292892,1.292892 -1,2c-0.707108,0.707108 -1,1 -1,2c0,1 -0.617317,1.076126 -1,2c-0.541195,1.306564 -1.458805,1.693436 -2,3c-0.382683,0.923874 -1,1 -1,2c0,1 -0.292892,1.292892 -1,2c-0.707108,0.707108 -0.292892,1.292892 -1,2c-0.707108,0.707108 -1,1 -1,2c0,1 -0.292892,1.292892 -1,2c-0.707108,0.707108 -0.292892,1.292892 -1,2c-0.707108,0.707108 -0.292892,1.292892 -1,2c-0.707108,0.707108 0,2 0,3c0,1 -1,1 -1,2c0,1 -0.292892,1.292892 -1,2c-0.707108,0.707108 0,2 0,3c0,1 -1,1 -1,2c0,1 0.707108,2.292892 0,3c-0.707108,0.707108 -1,1 -1,2c0,1 0,2 0,3c0,1 0,2 0,3c0,1 0,2 0,3c0,1 -0.292892,1.292908 -1,2c-0.707108,0.707092 0,2 0,3c0,1 0,2 0,3c0,1 -0.292892,1.292908 -1,2c-0.707108,0.707092 0,2 0,3c0,1 -1,1 -1,2c0,1 -1,1 -1,2c0,1 -1,1 -1,2c0,1 -0.292892,1.292908 -1,2c-0.707108,0.707092 -0.292892,1.292908 -1,2c-0.707108,0.707092 0,2 0,3c0,1 -1,1 -1,2c0,1 -0.292892,1.292908 -1,2c-0.707107,0.707092 0,2 0,3c0,1 -0.292893,1.292908 -1,2c-0.707107,0.707092 0.707107,2.292908 0,3c-0.707107,0.707092 -1,1 -1,2c0,1 0,2 0,3c0,1 0.707107,2.292908 0,3c-0.707107,0.707092 -1,1 -1,2c0,1 -0.292893,1.292908 -1,2c-0.707107,0.707092 -0.292893,1.292908 -1,2c-0.707107,0.707092 0,2 0,3c0,1 -1,1 -1,2c0,1 0,2 0,3c0,1 0,2 0,3c0,1 0,2 0,3c0,1 0,2 0,3c0,1 0,2 0,3c0,1 0,2 0,3c0,1 0,2 0,3c0,1 0.292893,1.292908 1,2c0.707107,0.707092 -0.707107,2.292908 0,3c0.707107,0.707092 1,1 1,2c0,1 -0.707107,2.292908 0,3c0.707107,0.707092 1,1 1,2c0,1 1,1 1,2c0,1 1,1 1,2c0,1 0,2 0,3c0,1 1,1 1,2c0,1 0,2 0,3c0,1 0,2 0,3c0,1 0,2 0,3c0,1 0,2 0,3c0,1 0,2 0,3c0,1 0,2 0,3c0,1 0,2 0,3c0,1 0,2 0,3c0,1 0,2 0,3c0,1 0,2 0,3c0,1 0.292892,1.292908 1,2c0.707108,0.707092 0,2 0,3c0,1 0,2 0,3c0,2 0,3 0,4c0,1 1,2 1,3c0,1 1,1 1,2c0,1 0,2 0,3c0,1 1,2 1,3c0,1 -0.707108,2.292908 0,3c0.707108,0.707092 0.292892,1.292908 1,2c0.707108,0.707092 0.234632,1.152252 1,3c0.541197,1.306549 1,2 1,3c0,1 1,1 1,2c0,1 -0.414213,1.585785 1,3c0.707108,0.707092 1,1 1,2c0,1 0.292892,1.292908 1,2c0.707108,0.707092 -0.707108,2.292908 0,3c0.707108,0.707092 1,1 1,2c0,1 0.617317,1.076111 1,2c0.541197,1.306549 1,2 1,3c0,1 1,1 1,2c0,1 0.292892,1.292908 1,2c0.707108,0.707092 0.458805,1.693451 1,3c0.382683,0.923889 0,2 0,3c0,1 1,1 1,2c0,1 0.292892,1.292908 1,2c0.707108,0.707092 0,2 0,3c0,1 0,2 0,3c0,1 0.617317,1.076111 1,2c0.541195,1.306549 1,2 1,3c0,1 0,2 0,3c0,1 0,2 0,3c0,1 0,2 0,3c0,1 0.292892,1.292908 1,2c0.707108,0.707092 -0.707108,2.292908 0,3c0.707108,0.707092 0.292892,1.292908 1,2c0.707108,0.707092 1,1 1,2c0,1 1,1 1,2c0,1 0,2 0,3c0,1 1,1 1,2c0,1 0.292892,1.292908 1,2c0.707108,0.707092 1,1 1,2l0,1")
      curve: 'linear'
      time: 2
      pathOptions:
        autoRotate: false

    @marker_3Animation_Turn_2 = new Animation
      layer: @marker_3
      path: Path.fromString("M43,488.5c0,1 0.292892,1.292908 1,2c0.707108,0.707092 0.292892,1.292908 1,2c0.707108,0.707092 0.292892,1.292908 1,2c0.707108,0.707092 1,1 1,2c0,1 0.292892,1.292908 1,2c0.707108,0.707092 1.292892,0.292908 2,1c0.707108,0.707092 0.292892,1.292908 1,2c0.707108,0.707092 1,1 1,2c0,1 0.292892,1.292908 1,2c0.707108,0.707092 2,0 2,1c0,1 0.617317,1.076111 1,2c0.541195,1.306549 1.292892,1.292908 2,2c0.707108,0.707092 1,1 1,2c0,1 1,1 1,2c0,1 1,1 1,2c0,1 0.617317,1.076111 1,2c0.541195,1.30658 1.292892,1.292908 2,2c0.707108,0.707092 -0.306564,2.458801 1,3c0.923882,0.38269 0.292892,1.292908 1,2c0.707108,0.707092 0.617317,1.076111 1,2c0.541199,1.30658 1.458801,1.69342 2,3c0.382683,0.923889 0.292892,1.292908 1,2c0.707108,0.707092 1.292892,0.292908 2,1c0.707108,0.707092 1,1 1,2c0,1 1,1 1,2c0,1 0.474266,1.149353 1,2c1.175568,1.9021 1.617317,2.076111 2,3c0.541199,1.30658 1,2 2,2c1,0 0.292892,1.292908 1,2c0.707108,0.707092 1.292892,0.292908 2,1c0.707108,0.707092 0.617317,1.076111 1,2c0.541199,1.30658 1.292892,1.292908 2,2c0.707108,0.707092 0.292892,1.292908 1,2c0.707108,0.707092 0.617317,1.076111 1,2c0.541199,1.30658 0.292892,2.292908 1,3c0.707108,0.707092 2.458801,0.69342 3,2c0.382683,0.923889 0.292892,1.292908 1,2c0.707108,0.707092 2,0 2,1c0,1 0.292892,1.292908 1,2c0.707108,0.707092 1.292892,0.292908 2,1c0.707108,0.707092 0.292892,1.292908 1,2c0.707108,0.707092 1.292892,0.292908 2,1c0.707108,0.707092 0.292892,1.292908 1,2c0.707108,0.707092 1.458801,0.69342 2,2c0.382683,0.923889 1.458801,0.69342 2,2c0.382683,0.923889 1,1 2,2c1,1 1.292892,2.292908 2,3c0.707108,0.707092 1.292892,1.292908 2,2c0.707108,0.707092 1.292892,0.292908 2,1c0.707108,0.707092 0.292892,2.292908 1,3c0.707108,0.707092 1.292892,0.292908 2,1c0.707108,0.707092 -0.306564,2.458801 1,3c0.923882,0.38269 1.292892,0.292908 2,1c0.707108,0.707092 0.292892,1.292908 1,2c0.707108,0.707092 1.292892,0.292908 2,1c0.707108,0.707092 0.292892,1.292908 1,2c0.707108,0.707092 0.292892,1.292908 1,2c0.707108,0.707092 1.292892,0.292908 2,1c0.707108,0.707092 0.292892,1.292908 1,2c0.707108,0.707092 0.693436,1.458801 2,2c0.923874,0.38269 1.292892,0.292908 2,1c0.707108,0.707092 1.076126,0.61731 2,1c1.306564,0.541199 2,2 3,3c1,1 3.076126,1.61731 4,2c1.306564,0.541199 2.186005,1.692566 4,3c1.147263,0.826904 2,2 3,2c1,0 0.292892,1.292908 1,2c0.707108,0.707092 1.292892,0.292908 2,1c0.707108,0.707092 2.292892,-0.707092 3,0c0.707108,0.707092 1,1 1,2c0,1 0.292892,1.292908 1,2c0.707108,0.707092 1.61731,0.076111 2,1c0.541199,1.30658 1.076126,1.61731 2,2c1.306564,0.541199 1.292892,1.292908 2,2c0.707108,0.707092 1.292892,0.292908 2,1c0.707108,0.707092 0.61731,1.076111 1,2c0.541199,1.30658 1.292892,1.292908 2,2c0.707108,0.707092 1,1 2,1c1,0 0.292892,1.292908 1,2c0.707108,0.707092 1.292892,0.292908 2,1c0.707108,0.707092 1.292892,0.292908 2,1c0.707108,0.707092 0.292892,1.292908 1,2c0.707108,0.707092 1,1 2,1c1,0 1.292892,0.292908 2,1c0.707108,0.707092 1.292892,0.292908 2,1c0.707108,0.707092 1,1 2,1l1,0l1,0")
      curve: 'linear'
      time: 1
      pathOptions:
        autoRotate: false

    @marker_3Animation_Turn_3 = new Animation
      layer: @marker_3
      path: Path.fromString("M185,644.5c-1,0 -1.292892,-0.292908 -2,-1c-0.707108,-0.707092 -0.61731,-1.076111 -1,-2c-0.541199,-1.30658 -1.292892,-1.292908 -2,-2c-0.707108,-0.707092 -1.292892,-0.292908 -2,-1c-0.707108,-0.707092 -0.292892,-1.292908 -1,-2c-0.707108,-0.707092 -1.292892,-0.292908 -2,-1c-0.707108,-0.707092 -0.292892,-1.292908 -1,-2c-0.707108,-0.707092 -1,-1 -2,-1c-1,0 -1.292892,-0.292908 -2,-1c-0.707108,-0.707092 -1.292892,-0.292908 -2,-1c-0.707108,-0.707092 -1,-1 -2,-1c-1,0 -0.292892,-1.292908 -1,-2c-0.707108,-0.707092 -1.292892,-0.292908 -2,-1c-0.707108,-0.707092 -1.292892,-0.292908 -2,-1c-0.707108,-0.707092 -2.292892,0.707092 -3,0c-0.707108,-0.707092 -0.292892,-1.292908 -1,-2c-0.707108,-0.707092 -1.292892,-0.292908 -2,-1c-0.707108,-0.707092 -0.796997,-1.256531 -2,-2c-2.689987,-1.662537 -4.292892,-0.292908 -5,-1c-0.707108,-0.707092 -0.292892,-1.292908 -1,-2c-0.707108,-0.707092 -1.292892,-0.292908 -2,-1c-0.707108,-0.707092 -1,-1 -3,-3c-2,-2 -2.692551,-2.186035 -4,-4c-0.826904,-1.147278 -2,-3 -4,-4c-2,-1 -4,-3 -5,-4c-2,-2 -5,-5 -6,-6c-1,-1 -3,-2 -4,-3c-1,-1 -2.186005,-1.692566 -4,-3c-1.14727,-0.826904 -1.298698,-0.948547 -3,-2c-1.902115,-1.175598 -4,-3 -5,-4c-2,-2 -2.292892,-2.292908 -3,-3c-0.707108,-0.707092 -1.85273,-0.173096 -3,-1c-1.813995,-1.307434 -3,-2 -5,-4c-1,-1 -1.292892,-2.292908 -2,-3c-0.707108,-0.707092 -0.474266,-1.149353 -1,-2c-1.175568,-1.9021 -3.458801,-2.69342 -4,-4c-0.765366,-1.847778 -1.292892,-2.292908 -2,-3c-0.707108,-0.707092 0.707108,-2.292908 0,-3c-0.707108,-0.707092 -0.693436,-1.458801 -2,-2c-0.923882,-0.38269 -0.617317,-1.076111 -1,-2c-0.541199,-1.30658 -0.692551,-3.186035 -2,-5c-0.826904,-1.147278 -1.234634,-2.152222 -2,-4c-0.541199,-1.30658 -1.770248,-2.026733 -2,-3c-0.513741,-2.17627 -1.617317,-3.076111 -2,-4c-0.541199,-1.30658 -0.617317,-2.076111 -1,-3c-0.541199,-1.30658 -2.486259,-1.82373 -3,-4c-0.229752,-0.973267 -1.458801,-1.69342 -2,-3c-0.765366,-1.847778 -1.458801,-4.69342 -2,-6c-0.765366,-1.847778 -1.292892,-2.292908 -2,-3c-0.707108,-0.707092 -1,-1 -1,-2c0,-1 -0.292892,-1.292908 -1,-2c-0.707108,-0.707092 -0.617317,-2.076111 -1,-3c-0.541195,-1.30658 -1.458805,-1.69342 -2,-3c-0.382683,-0.923889 -1.486256,-2.823761 -2,-5c-0.229752,-0.973236 -0.234634,-2.152252 -1,-4c-1.082394,-2.613129 -2.486256,-2.823761 -3,-5c-0.459507,-1.946503 -0.540493,-4.053497 -1,-6c-0.513744,-2.176239 -1.770248,-4.026764 -2,-5c-0.513744,-2.176239 -0.770248,-4.026764 -1,-5c-0.513744,-2.176239 -0.692547,-4.186005 -2,-6c-0.826904,-1.147278 -1,-4 -1,-5c0,-2 -0.493458,-3.878571 -1,-7c-0.480545,-2.961273 0,-6 0,-10c0,-3 -0.540493,-6.053497 -1,-8c-0.513744,-2.176239 -0.234634,-4.152252 -1,-6c-0.541195,-1.306549 -1,-2 -1,-3c0,-1 -1.486256,-0.823761 -2,-3c-0.229752,-0.973236 -0.149349,-1.474274 -1,-2c-1.902115,-1.175568 -1,-3 -1,-4c0,-1 -1.292892,-1.292908 -2,-2c-0.707108,-0.707092 0.382683,-2.076111 0,-3c-0.541195,-1.306549 -1,-2 -1,-3c0,-1 -1.292892,-1.292908 -2,-2c-0.707108,-0.707092 0,-2 0,-3c0,-1 -0.770248,-2.026764 -1,-3c-0.513744,-2.176239 -1,-3 -1,-5c0,-1 -1,-3 -1,-4c0,-2 -1,-4 -1,-6c0,-1 0,-2 0,-3c0,-1 -0.458803,-2.693451 -1,-4c-0.765368,-1.847748 0.459505,-3.053497 0,-5c-0.513742,-2.176239 -1,-3 -1,-5c0,-1 -1,-3 -1,-4c0,-1 0,-3 0,-4c0,-1 -1,-2 -1,-3c0,-1 0,-2 0,-3c0,-1 0.707108,-2.292908 0,-3c-0.707108,-0.707092 -1,-1 -1,-2c0,-1 0.707108,-2.292908 0,-3c-0.707108,-0.707092 -1.292892,-1.292908 -2,-2c-0.707108,-0.707092 0,-2 0,-3c0,-1 0,-2 0,-3c0,-1 -0.486258,-2.823761 -1,-5c-0.229753,-0.973236 0,-3 0,-4c0,-1 0,-2 0,-3c0,-1 0,-2 0,-4c0,-1 0.382683,-3.076111 0,-4c-0.541197,-1.306549 -1,-3 -1,-4c0,-2 0,-3 0,-4c0,-1 -0.459505,-3.053497 0,-5c0.513742,-2.176239 0.789848,-4.07843 2,-7c0.855705,-2.065857 1.486258,-2.823761 2,-5c0.459505,-1.946503 0.486258,-2.823761 1,-5c0.459505,-1.946503 1.458803,-3.693451 2,-5c0.765368,-1.847748 1,-3 1,-4c0,-1 0.292892,-1.292908 1,-2c0.707108,-0.707092 1,-3 1,-4c0,-1 0,-2 0,-3c0,-1 0,-2 0,-4c0,-1 -0.459505,-3.053497 0,-5c0.513744,-2.176239 1,-3 1,-5c0,-1 0,-2 0,-3c0,-1 1,-2 1,-3c0,-1 0,-2 0,-3c0,-1 0.292892,-1.292908 1,-2c0.707108,-0.707108 0.458805,-2.693436 1,-4c0.765366,-1.847763 0.692547,-4.186005 2,-6c0.826904,-1.147263 1.486256,-2.823746 2,-5c0.459507,-1.946503 0.770248,-3.026749 1,-4c0.513744,-2.176254 2,-3 2,-5c0,-1 0.486256,-1.823746 1,-4c0.229752,-0.973251 0.458805,-2.693436 1,-4c0.382683,-0.923874 1,-2 1,-3c0,-1 0.486256,-2.823746 1,-5c0.459507,-1.946503 1,-5 1,-6c0,-1 1.486256,-1.823746 2,-4c0.229752,-0.973251 0,-2 0,-3c0,-1 1.458805,-2.693436 2,-4c0.765366,-1.847763 1,-3 1,-4c0,-1 1,-2 1,-3c0,-1 0.770248,-3.026749 1,-4c0.513744,-2.176254 1.770248,-3.026749 2,-4c0.513744,-2.176254 2.486256,-3.823746 3,-6c0.229752,-0.973251 0.617317,-3.076126 1,-4c0.541195,-1.306564 1.292892,-1.292892 2,-2c0.707108,-0.707108 0.292892,-1.292892 1,-2c0.707108,-0.707108 0.292892,-1.292892 1,-2c0.707108,-0.707108 1.292892,-0.292892 2,-1c0.707108,-0.707108 1.292892,-0.292892 2,-1c0.707108,-0.707108 1.076118,-0.61731 2,-1c1.306564,-0.541199 3,-2 4,-3c1,-1 2.076118,-1.61731 3,-2c5.22625,-2.16478 5.693436,-6.458801 7,-7c0.923882,-0.38269 0.693436,-1.458801 2,-2c0.923882,-0.38269 0.292892,-1.292892 1,-2c0.707108,-0.707108 1.292892,-1.292892 2,-2c0.707108,-0.707108 1.617317,-1.076126 2,-2c0.541199,-1.306564 1.076118,-1.61731 2,-2c1.306564,-0.541199 2.458801,-2.693436 3,-4c0.382683,-0.923874 1.292892,-0.292892 2,-1c0.707108,-0.707108 0.076118,-1.61731 1,-2c1.306564,-0.541199 1.076118,-1.61731 2,-2c1.306564,-0.541199 2,-2 5,-5c2,-2 4,-3 5,-4c1,-1 2,-2 3,-3c1,-1 1.85273,-2.173096 3,-3c1.813995,-1.307449 4,-3 5,-4c1,-1 2.076118,-2.617317 3,-3c1.306564,-0.541199 2.076126,-1.617317 3,-2c2.613129,-1.08239 3,-3 4,-4c1,-1 3,-2 4,-3c2,-2 4,-3 5,-4c1,-1 2.292892,-2.292892 3,-3c1.414215,-1.414215 3.906326,-2.103401 5,-3c2.78833,-2.285881 4.186005,-2.692551 6,-4c1.147263,-0.826904 2.906326,-2.103401 4,-3c2.78833,-2.285881 4.21167,-2.714119 7,-5c1.093674,-0.896599 1.693436,-1.458801 3,-2c0.923874,-0.382683 1.076126,-0.617317 2,-1c1.306564,-0.541199 1.693436,-2.458801 3,-3c0.923874,-0.382683 1.292892,-1.292892 2,-2c0.707108,-0.707108 1.693436,-1.458801 3,-2c0.923874,-0.382683 2.186005,-0.692551 4,-2c1.147263,-0.826904 2,-1 3,-2c1,-1 1.693436,-1.458801 3,-2c0.923874,-0.382683 1.761078,-1.415894 5,-3c2.840729,-1.389351 3.823746,-2.486256 6,-3c0.973251,-0.229752 2.076126,-0.617317 3,-1c1.306564,-0.541195 3.292892,-1.292892 4,-2c0.707108,-0.707108 0.292892,-1.292892 1,-2c0.707108,-0.707108 1.292892,-0.292892 2,-1c0.707108,-0.707108 2.292892,-0.292892 3,-1c0.707108,-0.707108 1.076126,-0.617317 2,-1c1.306564,-0.541195 1.292892,-1.292892 2,-2c0.707108,-0.707108 1.292892,-1.292892 2,-2c0.707108,-0.707108 2.458801,0.306564 3,-1c0.38269,-0.923878 1,-1 2,-1l1,0")
      curve: 'linear'
      time: 2
      pathOptions:
        autoRotate: false

    @marker_3Animation_moveMusikanten = new Animation
      layer: @marker_3
      path: Path.fromString("M334.5,239.5c0,0 -0.229767,0.026749 0,1c0.513733,2.176254 2,3 2,4c0,1 1.61731,6.076126 2,7c0.541199,1.306564 1.917603,1.386871 3,4c0.38269,0.923889 -1.051453,2.298706 0,4c1.175568,1.9021 2,3 2,4c0,1 0,2 0,3c0,1 0,2 0,4c0,1 1,5 1,6c0,3 0,5 0,7c0,1 0,4 0,6c0,1 0.458801,1.693451 1,3c1.148041,2.771637 0.173096,3.852722 1,5c1.307465,1.813995 1.486267,3.823761 2,6c0.229767,0.973236 1.486267,2.823761 2,5c0.229767,0.973236 0,2 0,4c0,1 1,1 1,3c0,1 -0.160187,2.012909 0,3c0.506531,3.121429 1.917603,3.386871 3,6c0.765381,1.847748 0,3 0,4c0,2 0,3 0,4c0,1 0.38269,4.076111 0,5c-1.082397,2.613129 -2,5 -3,5l-1,1")
      curve: 'linear'
      time: 24
      pathOptions:
        autoRotate: false

    @marker_2Animation_moveMusikanten = new Animation
      layer: @marker_2
      path: Path.fromString("M505.5,220.5c0,0 0,1 0,2c0,1 1,2 1,2c1,1 0.292908,2.292892 1,3c0.707092,0.707108 0.540497,2.053497 1,4c0.513733,2.176254 1,3 1,4c0,3 0,5 0,6c0,1 0,3 0,4c0,1 0,2 0,3c0,2 0,3 0,5c0,3 0,4 0,5c0,1 0,3 0,4c0,2 0,3 0,5c0,1 0,2 0,3c0,3 0,4 0,5c0,2 0,4 0,6c0,1 -0.38269,2.076111 0,3c0.541199,1.306549 1.292908,1.292908 2,2c1.414185,1.414215 2.458801,4.693451 3,6c0.765381,1.847748 0,3 0,4l0,4l0,2l0,1")
      curve: 'linear'
      time: 24
      pathOptions:
        autoRotate: false

    @marker_3Animation_Turn_3.on Events.AnimationEnd, =>
      @remainingDistanceValue.opacity = 1
      @remainingDistanceValue.text = 1500 + " m"
      @marker_3_animated = true
      @marker_1.isMoveToMeSlow = true
      @marker_1Animation_moveAwaySlow.start()



    @marker_1Animation_moveAwaySlow.on Events.AnimationEnd, =>
      # hier jetzt erstmal weiter nach der smartwatch
      @marker_1.x = 393
      @marker_1.y = 638

      @marker_2.x = 482
      @marker_2.y = 171

      @marker_3.x = 310
      @marker_3.y = 188

      @marker_3Animation_moveMusikanten.start()
      @marker_2Animation_moveMusikanten.start()

    @marker_3Animation_moveMusikanten.on Events.AnimationEnd, =>
      @marker_1.isMoveToMeFast = false
      @exploredPopupLayer.x = 0
      @exploredPopupLayer.states.switch("on")
      @marker_3.setExplored()
      @marker_3_animated = true
      Utils.delay 2, =>
        @exploredPopupLayer.states.switch("off")
        @remainingDistanceLayer.x = 0
        @remainingDistanceValue.opacity = 0

    @marker_1Animation_moveAwaySlow.on Events.AnimationEnd, =>
      @marker_1.isMoveToMeSlow = false

    @marker_1Animation_Turn.on Events.AnimationEnd, =>
      @marker_2Animation_Turn_2.start()
      @marker_3Animation_Turn_2.start()
      @marker_1Animation_slowWalk.start()
      @marker_1.isMoveToMeSlow = true

    @lastValue = 0

    @marker_1.on "change:point", =>
      now = new Date
      sec = Utils.round(((now - @startTime) / 1000),0)
      lastSec =  Utils.round(((now - @lastTime) / 1000),0)

      if sec <= @lastAnimationTime
        if lastSec == 1 and @lastValue != sec
          @currentRemainingValue = Utils.round(@currentRemainingValue - Utils.round((@lastMaxDistance / @lastAnimationTime), 0), 0)
          if @currentRemainingValue < 0
            @currentRemainingValue = 0
          @remainingDistanceValue.text = @currentRemainingValue + " m"
          @lastTime = now
          @lastValue = sec

    @markers.push(@marker_1)
    @markers.push(@marker_2)
    @markers.push(@marker_3)

    @currentSelection = @markers[0]

    @radarLayer.addSubLayer(@marker_1)
    @radarLayer.addSubLayer(@marker_2)
    @radarLayer.addSubLayer(@marker_3)

    sliderLayer = new Layer
      x:0
      y:Screen.height - 355
      width: Screen.width
      height: 150
      backgroundColor: @myBackgroundColor
      superLayer : this

    @minusIcon = new Layer
      x: 50
      y: 0
      width: 75
      height: 75
      image: "./images/icons/minus.png"
    sliderLayer.addSubLayer(@minusIcon);

    @plusIcon = new Layer
      x: 615
      y: 0
      width: 75
      height: 75
      image: "./images/icons/plus.png"
    sliderLayer.addSubLayer(@plusIcon);

    kmMax = new textLayer
      x: 520
      y: 50
      width: 150
      height: 100
      text:"10km"
      color: "rgb(255,255,255)"
      textAlign: "center"
      fontSize: 30
      fontFamily: "Calibri"
    sliderLayer.addSubLayer(kmMax);

    kmMin = new textLayer
      x: 70
      y: 50
      width: 150
      height: 100
      text:"1km"
      color: "rgb(255,255,255)"
      textAlign: "center"
      fontSize: 30
      fontFamily: "Calibri"
    sliderLayer.addSubLayer(kmMin);

    # Create a new Slider
    @sliderA = new SliderComponent
      knobSize: 50
      min: 1
      max: 10
      value: 1
      height: 8
      width:453
      x:145
      y:30

    @sliderValue = 1

    sliderLayer.addSubLayer(@sliderA );

    # Customize the slider
    @sliderA.fill.backgroundColor = "white"
    @sliderA.backgroundColor = "rgba(255,255,255,0.5)"
    @sliderA.knob.style.boxShadow = "0 0 0 1px rgba(0,0,0,0.1)"

    @sliderA.knob.backgroundColor = "white"

    # We initially downscale the knob
    # This way, the knob never gets blurry
    @sliderA.knob.scale = 0.8

    # Scale to 1 on DragStart
    @sliderA.knob.on Events.DragStart, ->
      this.animate
        properties: {scale: 1}
        curve: "spring(400, 30, 0)"

    # Scale back to its original scale on DragEnd
    @sliderA.knob.on Events.DragEnd, ->
      this.animate
        properties: {scale: 0.8}
        curve: "spring(400, 30, 0)"

    sliderLayer.addSubLayer(@sliderA);

    @remainingDistanceLayer = new Layer
      x:0
      y:Screen.height - 1260
      width: Screen.width
      height: 150
      opacity:1
      backgroundColor: @myBackgroundColor
      superLayer : this

    remainingDistanceLabel = new textLayer
      x:0
      y:0
      width: Screen.width
      height:120
      backgroundColor: @myBackgroundColor
      text:"Entfernung bis zum Ziel: "
      color: "rgb(255,255,255)"
      textAlign: "center"
      fontSize: 50
      fontFamily: "Calibri"

    @remainingDistanceLayer.addSubLayer(remainingDistanceLabel)

    @remainingDistanceValue = new textLayer
      x:0
      y:60
      width: Screen.width
      height:120
      backgroundColor: @myBackgroundColor
      text:"500 m"
      opacity: 0
      color: "rgb(255,255,255)"
      textAlign: "center"
      fontSize: 50
      fontFamily: "Calibri"

    @remainingDistanceLayer.addSubLayer(@remainingDistanceValue)

    @exploredPopupLayer = new Layer
      x:1500
      y:0
      width:Screen.width
      height:260
      opacity:0
      backgroundColor: "transparent"
      superLayer: this

    @exploredPopup = new Layer

      width:700
      height:260
      image: "./images/ueberseemuseum-entdeckt-nachricht.png"
      superLayer : @exploredPopupLayer
    @exploredPopup.center()

    @exploredPopupLayer.states.add
      on: opacity: 1
      off: opacity: 0

    @exploredPopupLayer.states.animationOptions =
      curve: "ease-out"
      time: 0.3

    @marker_1Animation_quickWalk.on Events.AnimationEnd, =>
      @marker_1.isMoveToMeFast = false
      @remainingDistanceLayer.x = 1500
      @exploredPopupLayer.x = 0
      @exploredPopupLayer.states.switch("on")
      @marker_1.setExplored()
      @marker_1_animated = true
      @exploredPopup.image = "./images/ueberseemuseum-entdeckt-nachricht.png"
      Utils.delay 2, =>
        @exploredPopupLayer.states.switch("off")
        @remainingDistanceLayer.x = 0
        @remainingDistanceValue.opacity = 0



  getDistanceOfPoints: (p1, p2) =>
    xs = 0
    ys = 0

    xs = p2.x - p1.x
    xs = xs * xs

    ys = p2.y - p1.y
    ys = ys * ys

    return Math.sqrt( xs + ys )

  getRadarLayer: () ->
    return @radarLayer

  getTitle: () ->
    return @title

  hideAllMarkers: ()->
    @marker_1.hidePopup()
    @marker_2.hidePopup()
    @marker_3.hidePopup()

  deSelectAllSelectedMarkers: (myMarker)=>
    for marker in @markers
      if myMarker != marker and !marker.isExplored()
        marker.setNormal()

  bindEvents: =>
    @exploredPopup.on Events.Click , =>
      @exploredPopupLayer.x = 1500
      @pageComponent.x = 1500
      @backIcon.opacity = 1
      @listView.detailSightView1.x = 0
      @remainingDistanceValue.opacity = 0
      @remainingDistanceLayer.x = 0

    @sliderA.on "change:value", =>
      roundedValue =  Utils.round(@sliderA.value, 0)

      if roundedValue > @sliderValue and roundedValue <= 10 and roundedValue != @sliderValue
        @marker_1.x = @marker_1.x + 17.5
        @marker_1.y = @marker_1.y - 17.5

        @marker_2.x = @marker_2.x - 8.5
        @marker_2.y = @marker_2.y - 8.5

        @marker_3.x = @marker_3.x + 14
        @marker_3.y = @marker_3.y + 14

      else if roundedValue < @sliderValue and roundedValue >= 0 and roundedValue != @sliderValue
        @marker_1.x = @marker_1.x - 17.5
        @marker_1.y = @marker_1.y + 17.5

        @marker_2.x = @marker_2.x + 8.5
        @marker_2.y = @marker_2.y + 8.5

        @marker_3.x = @marker_3.x - 14
        @marker_3.y = @marker_3.y - 14

      @sliderValue = roundedValue

    @plusIcon.on Events.Click, =>
      roundedValue = Utils.round(@sliderA.value + 1, 0)
      if roundedValue < 11 and roundedValue != @sliderValue
        @sliderA.value  = roundedValue
        @sliderValue = roundedValue

    @minusIcon.on Events.Click, =>
      roundedValue = Utils.round(@sliderA.value - 1, 0)
      if roundedValue > 0 and roundedValue != @sliderValue
        @sliderA.value = roundedValue
        @sliderValue = roundedValue

    @marker_1.getEmitter().on 'selected', =>
      this.deSelectAllSelectedMarkers(@marker_1)
      if @marker_1.isNormal()
        @marker_1.setSelected()
        #Hier Wert f�r Entfernung bis zum Ziel �ndern
        if !@marker_1_animated and !@marker_1.isAnimating
          @remainingDistanceValue.opacity = 1

          @marker_1Animation_Turn.start()
          @marker_2Animation_Turn.start()
          @marker_3Animation_Turn.start()

      else
        if !@marker_1.isExplored() and not @marker_1.isNormal()
          @marker_1.setNormal()

    @marker_2.getEmitter().on 'selected', =>
      this.deSelectAllSelectedMarkers(@marker_2)
      if @marker_2.isNormal()
        @marker_2.setSelected()
        #Hier Wert f�r Entfernung bis zum Ziel �ndern
      else
        if !@marker_2.isExplored() and not @marker_2.isNormal()
          @marker_2.setNormal()

    @marker_3.getEmitter().on 'selected', =>
      this.deSelectAllSelectedMarkers(@marker_3)
      if @marker_3.isNormal()
        @marker_3.setSelected()
        #Hier Wert f�r Entfernung bis zum Ziel �ndern
        if !@marker_3_animated and @marker_1_animated
          @marker_3Animation_Turn_3.start()
          @marker_2Animation_Turn_3.start()
          @remainingDistanceValue.opacity = 1
          @currentRemainingValue = 1500
          @remainingDistanceValue.text = 1500 + " m"

      else
        if !@marker_3.isExplored() and not @marker_3.isNormal()
          @marker_3.setNormal()

    @radarLayer.on Events.Click, =>
      this.hideAllMarkers()

